<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
   xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
   <head>
      <meta charset="UTF-8">
      <title>FuturePath | Assessment</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
      <link rel="stylesheet" th:href="@{/css/common.css}" />
      <link rel="stylesheet" th:href="@{/css/quiz-home.css}" />
      <style>
         /* General Card Style */
         .assessment-card {
         background: linear-gradient(145deg, #273777, #1f2b59);
         padding: 2.5rem 3rem;
         border-radius: 1rem;
         color: white;
         max-width: 700px;
         width: 100%;
         margin: 2rem auto;
         box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
         border: 1px solid #3d4b8a;
         transition: transform 0.3s ease, box-shadow 0.3s ease;
         text-align: center;
         box-sizing: border-box;
         }
         .assessment-card:hover {
         transform: translateY(-3px);
         box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
         }
         /* Titles & Text */
         .assessment-card h3, 
         .assessment-card h4 {
         font-size: 1.4rem;
         font-weight: 700;
         margin-bottom: 0.6rem;
         }
         .assessment-card p {
         color: #d8defa;
         font-size: 0.95rem;
         margin-bottom: 1.8rem;
         line-height: 1.6;
         }
         .assessment-card label {
         display: block;
         color: #ffffff;
         font-size: 1.5rem;
         margin-bottom: 1.8rem;
         font-weight: 600;
         letter-spacing: 0.5px;
         }
         /* Message Box */
         .assessment-card .message {
         font-size: 1rem;
         color: #d8defa;
         margin-bottom: 2.2rem;
         line-height: 1.7;
         background-color: rgba(255, 255, 255, 0.05);
         padding: 1.2rem 1.3rem;
         border-radius: 0.6rem;
         border-left: 3px solid #5673ff;
         text-align: left;
         }
         /* Buttons (Transparent with border only) */
         .assessment-card button {
         display: inline-flex;
         align-items: center;
         justify-content: center;
         gap: 0.5rem;
         margin: 0.5rem 1rem;
         padding: 0.9rem 2rem;
         font-size: 1.05rem;
         font-weight: 600;
         color: #ffffff;
         background: transparent;
         border: 2px solid #5673ff;
         border-radius: 0.5rem;
         cursor: pointer;
         transition: background 0.3s ease, transform 0.25s ease, box-shadow 0.3s ease;
         box-shadow: none;
         }
         .assessment-card button:hover {
         background: #5673ff;
         transform: translateY(-3px);
         box-shadow: 0 6px 18px rgba(68, 97, 255, 0.4);
         }
         .assessment-card button:active {
         transform: scale(0.98);
         }
         /* Degree Buttons */
         .degree-buttons {
         display: flex;
         flex-wrap: wrap;
         justify-content: center;
         gap: 1rem;
         margin-bottom: 1.5rem;
         }
         .degree-btn {
         background: transparent;
         border: 2px solid rgba(255, 255, 255, 0.4);
         border-radius: 0.5rem;
         padding: 0.8rem 1.2rem;
         color: white;
         font-weight: 500;
         cursor: pointer;
         transition: all 0.3s ease;
         }
         .degree-btn:hover {
         background: #5673ff;
         border-color: #5673ff;
         }
         .degree-btn.selected {
         background: #4461ff;
         border-color: #4461ff;
         color: #fff;
         box-shadow: 0 0 10px rgba(68, 97, 255, 0.4);
         }
         /* Selected Degree/Strand Chips */
         .selected-items {
         display: flex;
         flex-wrap: wrap;
         justify-content: center;
         gap: 0.4rem;
         margin-bottom: 1rem;
         }
         .selected-items span {
         background-color: rgba(255, 255, 255, 0.15);
         border: 1px solid rgba(255, 255, 255, 0.25);
         padding: 0.3rem 0.7rem;
         border-radius: 0.4rem;
         color: #fff;
         font-size: 0.9rem;
         display: flex;
         align-items: center;
         gap: 0.3rem;
         }
         .selected-items span i {
         font-size: 0.8rem;
         cursor: pointer;
         color: #ff6b6b;
         }
         #collegeOptions, #strandOptions {
         display: none;
         }
         .assessment-card hr {
         border: none;
         height: 1px;
         background: rgba(255, 255, 255, 0.15);
         margin: 2rem 0;
         }
      </style>
   </head>
   <body>
      <nav th:replace="~{sidebar :: sidebar}"></nav>
      <main>
         <nav th:replace="~{header :: header}"></nav>
         <hr>
         <nav class="sub-header">ASSESSMENT</nav>
         <hr>
         <div class="content">
            <!-- CARD 1: Choose Assessment Type -->
            <form th:action="@{/assessment}" method="POST" th:object="${assessmentDto}" class="assessment-card" id="assessmentForm">
               <label>Which one would you take the assessment for?</label>
               <div class="message">
                  Take this short assessment to discover which <strong>college degree</strong> or 
                  <strong>senior high strand</strong> matches your strengths, interests, and goals.  
                  <br><br>
                  Whether you're aiming for a tech career, creative arts, or something else â€” 
                  letâ€™s find out which path is right for you! ðŸŒŸ
               </div>
               <button type="button" id="collegeBtn">
               <i class="fa-solid fa-graduation-cap"></i> FOR COLLEGE
               </button>
               <button type="button" id="strandBtn">
               <i class="fa-solid fa-school"></i> FOR SENIOR HIGH STRAND
               </button>
            </form>
            <!-- CARD 2: College Assessment -->
            <div id="collegeOptions" class="assessment-card">
               <h3>College Assessment Options</h3>
               <p>Choose between a default or custom college assessment.</p>
               <div class="message">
                  ðŸ’¡ <strong>Note:</strong> The default assessment automatically retrieves questions 
                  from all available college degree programs in the system.
               </div>
               <button type="submit" form="assessmentForm" name="mode" value="DEGREE-DEFAULT-MODE">Start Default Assessment</button>
               <hr>
               <h4>Custom Assessment</h4>
               <p>Select which degrees to include and how many questions to answer.</p>
               <div class="message">
                  ðŸ’¡ <strong>Note:</strong> The custom assessment will automatically generate 
                  randomized questions based on your input degree and question count.
               </div>
               <div class="degree-buttons">
                  <div class="degree-btn" data-degree="BSIT">BSIT</div>
                  <div class="degree-btn" data-degree="BSCS">BSCS</div>
                  <div class="degree-btn" data-degree="BSECE">BSECE</div>
                  <div class="degree-btn" data-degree="BSBA">BSBA</div>
                  <div class="degree-btn" data-degree="BSED">BSED</div>
                  <div class="degree-btn" data-degree="BSHM">BSHM</div>
               </div>
               <div id="selectedDegrees" class="selected-items"></div>
               <input type="hidden" name="degrees" id="degreeInput">
               <button type="submit" form="assessmentForm" name="mode" value="DEGREE-CUSTOM-MODE">Start Custom Assessment</button>
            </div>
            <!-- CARD 3: Strand Assessment -->
            <div id="strandOptions" class="assessment-card">
               <h3>Senior High Strand Assessment</h3>
               <p>Choose between a default or custom strand assessment.</p>
               <div class="message">
                  ðŸ’¡ <strong>Note:</strong> The default assessment retrieves questions 
                  from all strands available in the system.
               </div>
               <button type="submit" form="assessmentForm" name="mode" value="STRAND-DEFAULT-MODE">Start Default Assessment</button>
               <hr>
               <h4>Custom Strand Assessment</h4>
               <p>Select strands and question count for a personalized test.</p>
               <div class="message">
                  ðŸ’¡ <strong>Note:</strong> The custom strand assessment randomizes questions 
                  based on your chosen strands and question limit.
               </div>
               <div class="degree-buttons">
                  <div class="degree-btn" data-degree="STEM">STEM</div>
                  <div class="degree-btn" data-degree="HUMSS">HUMSS</div>
                  <div class="degree-btn" data-degree="ABM">ABM</div>
                  <div class="degree-btn" data-degree="GAS">GAS</div>
                  <div class="degree-btn" data-degree="TVL">TVL</div>
               </div>
               <div id="selectedStrands" class="selected-items"></div>
               <input type="hidden" name="strands" id="strandInput">
               <button type="submit" form="assessmentForm" name="mode" value="STRAND-CUSTOM-MODE">Start Custom Assessment</button>
            </div>
         </div>
      </main>
      <script>
         const collegeBtn = document.getElementById('collegeBtn');
         const strandBtn = document.getElementById('strandBtn');
         const collegeOptions = document.getElementById('collegeOptions');
         const strandOptions = document.getElementById('strandOptions');
         
         collegeBtn.addEventListener('click', () => {
           strandOptions.style.display = 'none';
           collegeOptions.style.display = 'block';
           window.scrollTo({ top: collegeOptions.offsetTop - 80, behavior: 'smooth' });
         });
         
         strandBtn.addEventListener('click', () => {
           collegeOptions.style.display = 'none';
           strandOptions.style.display = 'block';
           window.scrollTo({ top: strandOptions.offsetTop - 80, behavior: 'smooth' });
         });
         
         // Shared degree/strand selection logic
         function setupSelection(buttonSelector, containerId, inputId) {
           const buttons = document.querySelectorAll(buttonSelector);
           const container = document.getElementById(containerId);
           const hiddenInput = document.getElementById(inputId);
           let selected = [];
         
           buttons.forEach(btn => {
             btn.addEventListener('click', () => {
               const val = btn.dataset.degree;
               if (selected.includes(val)) {
                 selected = selected.filter(d => d !== val);
                 btn.classList.remove('selected');
               } else {
                 selected.push(val);
                 btn.classList.add('selected');
               }
               updatePreview(container, selected, hiddenInput, buttonSelector);
             });
           });
         }
         
         function updatePreview(container, selected, hiddenInput, buttonSelector) {
           container.innerHTML = '';
           selected.forEach(val => {
             const span = document.createElement('span');
             span.innerHTML = `${val} <i class="fa-solid fa-xmark"></i>`;
             span.querySelector('i').addEventListener('click', () => {
               selected.splice(selected.indexOf(val), 1);
               document.querySelector(`${buttonSelector}[data-degree="${val}"]`).classList.remove('selected');
               updatePreview(container, selected, hiddenInput, buttonSelector);
             });
             container.appendChild(span);
           });
           hiddenInput.value = selected.join(',');
         }
         
         setupSelection('#collegeOptions .degree-btn', 'selectedDegrees', 'degreeInput');
         setupSelection('#strandOptions .degree-btn', 'selectedStrands', 'strandInput');
      </script>
   </body>
</html>